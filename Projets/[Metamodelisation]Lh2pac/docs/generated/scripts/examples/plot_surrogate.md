
<!--
 DO NOT EDIT.
 THIS FILE WAS AUTOMATICALLY GENERATED BY mkdocs-gallery.
 TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
 "docs/scripts/examples/plot_surrogate.py"
 LINE NUMBERS ARE GIVEN BELOW.
-->

!!! note

    Click [here](#download_links)
    to download the full example code


# Surrogate model

In this example,
we will build a surrogate model of the Rosenbrock function
and a constraint related to an Rosenbrock-based optimization problem.

<!-- GENERATED FROM PYTHON SOURCE LINES 8-20 -->

```{.python }

import pickle
from pathlib import Path

from gemseo import create_design_space
from gemseo import create_discipline
from gemseo import create_surrogate
from gemseo import import_discipline
from gemseo.mlearning.quality_measures.r2_measure import R2Measure
from gemseo.mlearning.quality_measures.rmse_measure import RMSEMeasure
from gemseo_mlearning.api import sample_discipline

```








<!-- GENERATED FROM PYTHON SOURCE LINES 21-24 -->

Firstly,
we define the discipline computing the Rosenbrock function
and the Euclidean distance to the optimum:

<!-- GENERATED FROM PYTHON SOURCE LINES 24-32 -->

```{.python }
from numpy import array

discipline = create_discipline(
    "AnalyticDiscipline",
    expressions={"z": "(1-x)**2+100*(y-x**2)**2", "c": "((x-1)**2+(y-1)**2)**0.5"},
    name="Rosenbrock",
)

```








<!-- GENERATED FROM PYTHON SOURCE LINES 33-34 -->

Then, we create the design space:

<!-- GENERATED FROM PYTHON SOURCE LINES 34-38 -->

```{.python }
design_space = create_design_space()
design_space.add_variable("x", l_b=-2.0, u_b=2.0, value=0.0)
design_space.add_variable("y", l_b=-2.0, u_b=2.0, value=0.0)

```








<!-- GENERATED FROM PYTHON SOURCE LINES 39-41 -->

Then,
we sample the discipline with an optimal LHS:

<!-- GENERATED FROM PYTHON SOURCE LINES 41-43 -->

```{.python }
dataset = sample_discipline(discipline, design_space, ["z", "c"], "OT_OPT_LHS", 30)

```




Out:
{: .mkd-glr-script-out }

```{.shell .mkd-glr-script-out-disp }
/home/mickael/ModIA_5A/Metamodelisation/lh2pac/.venv/lib/python3.9/site-packages/pandas/core/frame.py:706: DeprecationWarning: Passing a BlockManager to IODataset is deprecated and will raise in a future version. Use public APIs instead.
  warnings.warn(

```





<!-- GENERATED FROM PYTHON SOURCE LINES 44-45 -->

before creating a surrogate discipline:

<!-- GENERATED FROM PYTHON SOURCE LINES 45-47 -->

```{.python }
surrogate_discipline = create_surrogate("RBFRegressor", dataset)

```




Out:
{: .mkd-glr-script-out }

```{.shell .mkd-glr-script-out-disp }
/home/mickael/ModIA_5A/Metamodelisation/lh2pac/.venv/lib/python3.9/site-packages/pandas/core/frame.py:706: DeprecationWarning: Passing a BlockManager to IODataset is deprecated and will raise in a future version. Use public APIs instead.
  warnings.warn(
/home/mickael/ModIA_5A/Metamodelisation/lh2pac/.venv/lib/python3.9/site-packages/pandas/core/frame.py:706: DeprecationWarning: Passing a BlockManager to IODataset is deprecated and will raise in a future version. Use public APIs instead.
  warnings.warn(
/home/mickael/ModIA_5A/Metamodelisation/lh2pac/.venv/lib/python3.9/site-packages/pandas/core/frame.py:706: DeprecationWarning: Passing a BlockManager to IODataset is deprecated and will raise in a future version. Use public APIs instead.
  warnings.warn(
/home/mickael/ModIA_5A/Metamodelisation/lh2pac/.venv/lib/python3.9/site-packages/pandas/core/frame.py:706: DeprecationWarning: Passing a BlockManager to IODataset is deprecated and will raise in a future version. Use public APIs instead.
  warnings.warn(
/home/mickael/ModIA_5A/Metamodelisation/lh2pac/.venv/lib/python3.9/site-packages/pandas/core/frame.py:706: DeprecationWarning: Passing a BlockManager to IODataset is deprecated and will raise in a future version. Use public APIs instead.
  warnings.warn(

```





<!-- GENERATED FROM PYTHON SOURCE LINES 48-49 -->

and using it for prediction:

<!-- GENERATED FROM PYTHON SOURCE LINES 49-52 -->

```{.python }
surrogate_discipline.execute({"x": array([1.0])})
surrogate_discipline.cache.last_entry

```




Out:
{: .mkd-glr-script-out }

```{.shell .mkd-glr-script-out-disp }
/home/mickael/ModIA_5A/Metamodelisation/lh2pac/.venv/lib/python3.9/site-packages/pandas/core/frame.py:706: DeprecationWarning: Passing a BlockManager to IODataset is deprecated and will raise in a future version. Use public APIs instead.
  warnings.warn(

CacheEntry(inputs={'x': array([1.]), 'y': array([0.01176985])}, outputs={'c': array([0.95861794]), 'z': array([97.71890412])}, jacobian={})
```





<!-- GENERATED FROM PYTHON SOURCE LINES 53-56 -->

This surrogate discipline can be used in a scenario.
The underlying regression model can also be assessed,
with the R2 measure for instance:

<!-- GENERATED FROM PYTHON SOURCE LINES 56-60 -->

```{.python }
r2 = R2Measure(surrogate_discipline.regression_model, True)
r2.compute_learning_measure()
r2.compute_cross_validation_measure()

```




Out:
{: .mkd-glr-script-out }

```{.shell .mkd-glr-script-out-disp }
/home/mickael/ModIA_5A/Metamodelisation/lh2pac/.venv/lib/python3.9/site-packages/pandas/core/frame.py:706: DeprecationWarning: Passing a BlockManager to IODataset is deprecated and will raise in a future version. Use public APIs instead.
  warnings.warn(
/home/mickael/ModIA_5A/Metamodelisation/lh2pac/.venv/lib/python3.9/site-packages/pandas/core/frame.py:706: DeprecationWarning: Passing a BlockManager to IODataset is deprecated and will raise in a future version. Use public APIs instead.
  warnings.warn(
/home/mickael/ModIA_5A/Metamodelisation/lh2pac/.venv/lib/python3.9/site-packages/pandas/core/frame.py:706: DeprecationWarning: Passing a BlockManager to IODataset is deprecated and will raise in a future version. Use public APIs instead.
  warnings.warn(
/home/mickael/ModIA_5A/Metamodelisation/lh2pac/.venv/lib/python3.9/site-packages/pandas/core/frame.py:706: DeprecationWarning: Passing a BlockManager to IODataset is deprecated and will raise in a future version. Use public APIs instead.
  warnings.warn(
/home/mickael/ModIA_5A/Metamodelisation/lh2pac/.venv/lib/python3.9/site-packages/pandas/core/frame.py:706: DeprecationWarning: Passing a BlockManager to IODataset is deprecated and will raise in a future version. Use public APIs instead.
  warnings.warn(
/home/mickael/ModIA_5A/Metamodelisation/lh2pac/.venv/lib/python3.9/site-packages/pandas/core/frame.py:706: DeprecationWarning: Passing a BlockManager to IODataset is deprecated and will raise in a future version. Use public APIs instead.
  warnings.warn(
/home/mickael/ModIA_5A/Metamodelisation/lh2pac/.venv/lib/python3.9/site-packages/pandas/core/frame.py:706: DeprecationWarning: Passing a BlockManager to IODataset is deprecated and will raise in a future version. Use public APIs instead.
  warnings.warn(
/home/mickael/ModIA_5A/Metamodelisation/lh2pac/.venv/lib/python3.9/site-packages/pandas/core/frame.py:706: DeprecationWarning: Passing a BlockManager to IODataset is deprecated and will raise in a future version. Use public APIs instead.
  warnings.warn(
/home/mickael/ModIA_5A/Metamodelisation/lh2pac/.venv/lib/python3.9/site-packages/pandas/core/frame.py:706: DeprecationWarning: Passing a BlockManager to IODataset is deprecated and will raise in a future version. Use public APIs instead.
  warnings.warn(
/home/mickael/ModIA_5A/Metamodelisation/lh2pac/.venv/lib/python3.9/site-packages/pandas/core/frame.py:706: DeprecationWarning: Passing a BlockManager to IODataset is deprecated and will raise in a future version. Use public APIs instead.
  warnings.warn(
/home/mickael/ModIA_5A/Metamodelisation/lh2pac/.venv/lib/python3.9/site-packages/pandas/core/frame.py:706: DeprecationWarning: Passing a BlockManager to IODataset is deprecated and will raise in a future version. Use public APIs instead.
  warnings.warn(
/home/mickael/ModIA_5A/Metamodelisation/lh2pac/.venv/lib/python3.9/site-packages/pandas/core/frame.py:706: DeprecationWarning: Passing a BlockManager to IODataset is deprecated and will raise in a future version. Use public APIs instead.
  warnings.warn(
/home/mickael/ModIA_5A/Metamodelisation/lh2pac/.venv/lib/python3.9/site-packages/pandas/core/frame.py:706: DeprecationWarning: Passing a BlockManager to IODataset is deprecated and will raise in a future version. Use public APIs instead.
  warnings.warn(
/home/mickael/ModIA_5A/Metamodelisation/lh2pac/.venv/lib/python3.9/site-packages/pandas/core/frame.py:706: DeprecationWarning: Passing a BlockManager to IODataset is deprecated and will raise in a future version. Use public APIs instead.
  warnings.warn(
/home/mickael/ModIA_5A/Metamodelisation/lh2pac/.venv/lib/python3.9/site-packages/pandas/core/frame.py:706: DeprecationWarning: Passing a BlockManager to IODataset is deprecated and will raise in a future version. Use public APIs instead.
  warnings.warn(
/home/mickael/ModIA_5A/Metamodelisation/lh2pac/.venv/lib/python3.9/site-packages/pandas/core/frame.py:706: DeprecationWarning: Passing a BlockManager to IODataset is deprecated and will raise in a future version. Use public APIs instead.
  warnings.warn(
/home/mickael/ModIA_5A/Metamodelisation/lh2pac/.venv/lib/python3.9/site-packages/pandas/core/frame.py:706: DeprecationWarning: Passing a BlockManager to IODataset is deprecated and will raise in a future version. Use public APIs instead.
  warnings.warn(
/home/mickael/ModIA_5A/Metamodelisation/lh2pac/.venv/lib/python3.9/site-packages/pandas/core/frame.py:706: DeprecationWarning: Passing a BlockManager to IODataset is deprecated and will raise in a future version. Use public APIs instead.
  warnings.warn(
/home/mickael/ModIA_5A/Metamodelisation/lh2pac/.venv/lib/python3.9/site-packages/pandas/core/frame.py:706: DeprecationWarning: Passing a BlockManager to IODataset is deprecated and will raise in a future version. Use public APIs instead.
  warnings.warn(
/home/mickael/ModIA_5A/Metamodelisation/lh2pac/.venv/lib/python3.9/site-packages/pandas/core/frame.py:706: DeprecationWarning: Passing a BlockManager to IODataset is deprecated and will raise in a future version. Use public APIs instead.
  warnings.warn(
/home/mickael/ModIA_5A/Metamodelisation/lh2pac/.venv/lib/python3.9/site-packages/pandas/core/frame.py:706: DeprecationWarning: Passing a BlockManager to IODataset is deprecated and will raise in a future version. Use public APIs instead.
  warnings.warn(
/home/mickael/ModIA_5A/Metamodelisation/lh2pac/.venv/lib/python3.9/site-packages/pandas/core/frame.py:706: DeprecationWarning: Passing a BlockManager to IODataset is deprecated and will raise in a future version. Use public APIs instead.
  warnings.warn(
/home/mickael/ModIA_5A/Metamodelisation/lh2pac/.venv/lib/python3.9/site-packages/pandas/core/frame.py:706: DeprecationWarning: Passing a BlockManager to IODataset is deprecated and will raise in a future version. Use public APIs instead.
  warnings.warn(
/home/mickael/ModIA_5A/Metamodelisation/lh2pac/.venv/lib/python3.9/site-packages/pandas/core/frame.py:706: DeprecationWarning: Passing a BlockManager to IODataset is deprecated and will raise in a future version. Use public APIs instead.
  warnings.warn(
/home/mickael/ModIA_5A/Metamodelisation/lh2pac/.venv/lib/python3.9/site-packages/pandas/core/frame.py:706: DeprecationWarning: Passing a BlockManager to IODataset is deprecated and will raise in a future version. Use public APIs instead.
  warnings.warn(
/home/mickael/ModIA_5A/Metamodelisation/lh2pac/.venv/lib/python3.9/site-packages/pandas/core/frame.py:706: DeprecationWarning: Passing a BlockManager to IODataset is deprecated and will raise in a future version. Use public APIs instead.
  warnings.warn(
/home/mickael/ModIA_5A/Metamodelisation/lh2pac/.venv/lib/python3.9/site-packages/pandas/core/frame.py:706: DeprecationWarning: Passing a BlockManager to IODataset is deprecated and will raise in a future version. Use public APIs instead.
  warnings.warn(
/home/mickael/ModIA_5A/Metamodelisation/lh2pac/.venv/lib/python3.9/site-packages/pandas/core/frame.py:706: DeprecationWarning: Passing a BlockManager to IODataset is deprecated and will raise in a future version. Use public APIs instead.
  warnings.warn(
/home/mickael/ModIA_5A/Metamodelisation/lh2pac/.venv/lib/python3.9/site-packages/pandas/core/frame.py:706: DeprecationWarning: Passing a BlockManager to IODataset is deprecated and will raise in a future version. Use public APIs instead.
  warnings.warn(
/home/mickael/ModIA_5A/Metamodelisation/lh2pac/.venv/lib/python3.9/site-packages/pandas/core/frame.py:706: DeprecationWarning: Passing a BlockManager to IODataset is deprecated and will raise in a future version. Use public APIs instead.
  warnings.warn(
/home/mickael/ModIA_5A/Metamodelisation/lh2pac/.venv/lib/python3.9/site-packages/pandas/core/frame.py:706: DeprecationWarning: Passing a BlockManager to IODataset is deprecated and will raise in a future version. Use public APIs instead.
  warnings.warn(
/home/mickael/ModIA_5A/Metamodelisation/lh2pac/.venv/lib/python3.9/site-packages/pandas/core/frame.py:706: DeprecationWarning: Passing a BlockManager to IODataset is deprecated and will raise in a future version. Use public APIs instead.
  warnings.warn(

array([0.99621966, 0.78601484])
```





<!-- GENERATED FROM PYTHON SOURCE LINES 61-62 -->

or with the root mean squared error:

<!-- GENERATED FROM PYTHON SOURCE LINES 62-72 -->

```{.python }
rmse = RMSEMeasure(surrogate_discipline.regression_model, True)
rmse.compute_learning_measure()
rmse.compute_cross_validation_measure()

with Path("my_surrogate.pkl").open("wb") as f:
    pickle.dump(surrogate_discipline, f)

discipline = import_discipline("my_surrogate.pkl")
discipline.execute({"x": array([1.0])})
discipline.get_output_data()
```




Out:
{: .mkd-glr-script-out }

```{.shell .mkd-glr-script-out-disp }
/home/mickael/ModIA_5A/Metamodelisation/lh2pac/.venv/lib/python3.9/site-packages/pandas/core/frame.py:706: DeprecationWarning: Passing a BlockManager to IODataset is deprecated and will raise in a future version. Use public APIs instead.
  warnings.warn(
/home/mickael/ModIA_5A/Metamodelisation/lh2pac/.venv/lib/python3.9/site-packages/pandas/core/frame.py:706: DeprecationWarning: Passing a BlockManager to IODataset is deprecated and will raise in a future version. Use public APIs instead.
  warnings.warn(
/home/mickael/ModIA_5A/Metamodelisation/lh2pac/.venv/lib/python3.9/site-packages/pandas/core/frame.py:706: DeprecationWarning: Passing a BlockManager to IODataset is deprecated and will raise in a future version. Use public APIs instead.
  warnings.warn(
/home/mickael/ModIA_5A/Metamodelisation/lh2pac/.venv/lib/python3.9/site-packages/pandas/core/frame.py:706: DeprecationWarning: Passing a BlockManager to IODataset is deprecated and will raise in a future version. Use public APIs instead.
  warnings.warn(
/home/mickael/ModIA_5A/Metamodelisation/lh2pac/.venv/lib/python3.9/site-packages/pandas/core/frame.py:706: DeprecationWarning: Passing a BlockManager to IODataset is deprecated and will raise in a future version. Use public APIs instead.
  warnings.warn(
/home/mickael/ModIA_5A/Metamodelisation/lh2pac/.venv/lib/python3.9/site-packages/pandas/core/frame.py:706: DeprecationWarning: Passing a BlockManager to IODataset is deprecated and will raise in a future version. Use public APIs instead.
  warnings.warn(
/home/mickael/ModIA_5A/Metamodelisation/lh2pac/.venv/lib/python3.9/site-packages/pandas/core/frame.py:706: DeprecationWarning: Passing a BlockManager to IODataset is deprecated and will raise in a future version. Use public APIs instead.
  warnings.warn(
/home/mickael/ModIA_5A/Metamodelisation/lh2pac/.venv/lib/python3.9/site-packages/pandas/core/frame.py:706: DeprecationWarning: Passing a BlockManager to IODataset is deprecated and will raise in a future version. Use public APIs instead.
  warnings.warn(
/home/mickael/ModIA_5A/Metamodelisation/lh2pac/.venv/lib/python3.9/site-packages/pandas/core/frame.py:706: DeprecationWarning: Passing a BlockManager to IODataset is deprecated and will raise in a future version. Use public APIs instead.
  warnings.warn(
/home/mickael/ModIA_5A/Metamodelisation/lh2pac/.venv/lib/python3.9/site-packages/pandas/core/frame.py:706: DeprecationWarning: Passing a BlockManager to IODataset is deprecated and will raise in a future version. Use public APIs instead.
  warnings.warn(
/home/mickael/ModIA_5A/Metamodelisation/lh2pac/.venv/lib/python3.9/site-packages/pandas/core/frame.py:706: DeprecationWarning: Passing a BlockManager to IODataset is deprecated and will raise in a future version. Use public APIs instead.
  warnings.warn(
/home/mickael/ModIA_5A/Metamodelisation/lh2pac/.venv/lib/python3.9/site-packages/pandas/core/frame.py:706: DeprecationWarning: Passing a BlockManager to IODataset is deprecated and will raise in a future version. Use public APIs instead.
  warnings.warn(
/home/mickael/ModIA_5A/Metamodelisation/lh2pac/.venv/lib/python3.9/site-packages/pandas/core/frame.py:706: DeprecationWarning: Passing a BlockManager to IODataset is deprecated and will raise in a future version. Use public APIs instead.
  warnings.warn(
/home/mickael/ModIA_5A/Metamodelisation/lh2pac/.venv/lib/python3.9/site-packages/pandas/core/frame.py:706: DeprecationWarning: Passing a BlockManager to IODataset is deprecated and will raise in a future version. Use public APIs instead.
  warnings.warn(
/home/mickael/ModIA_5A/Metamodelisation/lh2pac/.venv/lib/python3.9/site-packages/pandas/core/frame.py:706: DeprecationWarning: Passing a BlockManager to IODataset is deprecated and will raise in a future version. Use public APIs instead.
  warnings.warn(
/home/mickael/ModIA_5A/Metamodelisation/lh2pac/.venv/lib/python3.9/site-packages/pandas/core/frame.py:706: DeprecationWarning: Passing a BlockManager to IODataset is deprecated and will raise in a future version. Use public APIs instead.
  warnings.warn(
/home/mickael/ModIA_5A/Metamodelisation/lh2pac/.venv/lib/python3.9/site-packages/pandas/core/frame.py:706: DeprecationWarning: Passing a BlockManager to IODataset is deprecated and will raise in a future version. Use public APIs instead.
  warnings.warn(
/home/mickael/ModIA_5A/Metamodelisation/lh2pac/.venv/lib/python3.9/site-packages/pandas/core/frame.py:706: DeprecationWarning: Passing a BlockManager to IODataset is deprecated and will raise in a future version. Use public APIs instead.
  warnings.warn(
/home/mickael/ModIA_5A/Metamodelisation/lh2pac/.venv/lib/python3.9/site-packages/pandas/core/frame.py:706: DeprecationWarning: Passing a BlockManager to IODataset is deprecated and will raise in a future version. Use public APIs instead.
  warnings.warn(
/home/mickael/ModIA_5A/Metamodelisation/lh2pac/.venv/lib/python3.9/site-packages/pandas/core/frame.py:706: DeprecationWarning: Passing a BlockManager to IODataset is deprecated and will raise in a future version. Use public APIs instead.
  warnings.warn(
/home/mickael/ModIA_5A/Metamodelisation/lh2pac/.venv/lib/python3.9/site-packages/pandas/core/frame.py:706: DeprecationWarning: Passing a BlockManager to IODataset is deprecated and will raise in a future version. Use public APIs instead.
  warnings.warn(
/home/mickael/ModIA_5A/Metamodelisation/lh2pac/.venv/lib/python3.9/site-packages/pandas/core/frame.py:706: DeprecationWarning: Passing a BlockManager to IODataset is deprecated and will raise in a future version. Use public APIs instead.
  warnings.warn(
/home/mickael/ModIA_5A/Metamodelisation/lh2pac/.venv/lib/python3.9/site-packages/pandas/core/frame.py:706: DeprecationWarning: Passing a BlockManager to IODataset is deprecated and will raise in a future version. Use public APIs instead.
  warnings.warn(
/home/mickael/ModIA_5A/Metamodelisation/lh2pac/.venv/lib/python3.9/site-packages/pandas/core/frame.py:706: DeprecationWarning: Passing a BlockManager to IODataset is deprecated and will raise in a future version. Use public APIs instead.
  warnings.warn(
/home/mickael/ModIA_5A/Metamodelisation/lh2pac/.venv/lib/python3.9/site-packages/pandas/core/frame.py:706: DeprecationWarning: Passing a BlockManager to IODataset is deprecated and will raise in a future version. Use public APIs instead.
  warnings.warn(
/home/mickael/ModIA_5A/Metamodelisation/lh2pac/.venv/lib/python3.9/site-packages/pandas/core/frame.py:706: DeprecationWarning: Passing a BlockManager to IODataset is deprecated and will raise in a future version. Use public APIs instead.
  warnings.warn(
/home/mickael/ModIA_5A/Metamodelisation/lh2pac/.venv/lib/python3.9/site-packages/pandas/core/frame.py:706: DeprecationWarning: Passing a BlockManager to IODataset is deprecated and will raise in a future version. Use public APIs instead.
  warnings.warn(
/home/mickael/ModIA_5A/Metamodelisation/lh2pac/.venv/lib/python3.9/site-packages/pandas/core/frame.py:706: DeprecationWarning: Passing a BlockManager to IODataset is deprecated and will raise in a future version. Use public APIs instead.
  warnings.warn(

{'z': array([97.71890412]), 'c': array([0.95861794])}
```






**Total running time of the script:** ( 0 minutes  0.178 seconds)

<div id="download_links"></div>



[:fontawesome-solid-download: Download Python source code: plot_surrogate.py](./plot_surrogate.py){ .md-button .center}

[:fontawesome-solid-download: Download Jupyter notebook: plot_surrogate.ipynb](./plot_surrogate.ipynb){ .md-button .center}


[Gallery generated by mkdocs-gallery](https://mkdocs-gallery.github.io){: .mkd-glr-signature }
